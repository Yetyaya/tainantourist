"use strict";var tainanData,map,dataURL="https://next.json-generator.com/api/json/get/Vyw-hlJuN",xhr=new XMLHttpRequest;function initMap(e){map=new google.maps.Map(document.getElementById("map"),{center:{lat:22.9935789,lng:120.2911978},zoom:12,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#597c84"},{lightness:"-37"}]},{featureType:"administrative.province",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{lightness:"0"},{saturation:"0"},{color:"#f5f5f2"},{gamma:"1"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{lightness:"-3"},{gamma:"1.00"}]},{featureType:"landscape.natural.terrain",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#bae5ce"},{visibility:"on"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#fac9a9"},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{color:"#4e4e4e"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#787878"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"transit.station.airport",elementType:"labels.icon",stylers:[{hue:"#0a00ff"},{saturation:"-77"},{gamma:"0.57"},{lightness:"0"}]},{featureType:"transit.station.rail",elementType:"labels.text.fill",stylers:[{color:"#43321e"}]},{featureType:"transit.station.rail",elementType:"labels.icon",stylers:[{hue:"#ff6c00"},{lightness:"4"},{gamma:"0.75"},{saturation:"-68"}]},{featureType:"water",elementType:"all",stylers:[{color:"#eaf6f8"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#a8d7d8"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{lightness:"-49"},{saturation:"-53"},{gamma:"0.79"}]}]});for(var t=0;t<e.length;t++){var a={},n={};n.lat=parseFloat(e[t].lat),n.lng=parseFloat(e[t].long),a.position=n,a.map=map,a.title=e[t].name,new google.maps.Marker(a)}var l=new google.maps.InfoWindow({map:map});navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var a={lat:parseFloat(e[0].lat),lng:parseFloat(e[0].long)};map.setCenter(a)},function(){handleLocationError(!0,l,map.getCenter())}):handleLocationError(!1,l,map.getCenter())}xhr.open("get",dataURL,!0),xhr.send(null),xhr.onload=function(){var e=JSON.parse(xhr.responseText);tainanData=e},$(document).ready(function(){var e,t=document.getElementById("regionId"),a=document.querySelector(".regionBox"),n=document.querySelector(".list"),l=document.querySelector(".page");function r(t){n.innerHTML="",e=[];for(var a=0;a<tainanData.length;a++)document.querySelector(".regionName").textContent=t,t==tainanData[a].district?e.push(tainanData[a]):""==t&&(document.querySelector(".regionName").textContent="");initMap(e),0==e.length?document.querySelector(".noInfo").textContent="目前尚無此區景點資料":document.querySelector(".noInfo").textContent=""}t.addEventListener("change",function(e){r(e.target.value),$(".list").fadeOut(0),y(1)},!1),a.addEventListener("click",function(e){if("button"!==e.target.localName)return;var a=e.target.textContent;t.value=e.target.textContent,$(".list").fadeOut(0),r(a),y(1)},!1);var i,o,s=6,p=1;function y(t){var a,r,y=(o=e.length)/s;i=Math.ceil(y),l.style.display=i>1?"block":"none",t==i?(a=(i-1)*s,r=o):(a=(t-1)*s,r=t*s);var c="";if(0!=e.length){for(var u=a;u<r;u++)c+='<div class="localBox" data-id="'+u+'"><div class="pic"><img class="adjust" src="'+e[u].picture+'"/></div><h3 class="placeName">'+e[u].name+'<span class="placeRegion">'+e[u].district+'</span></h3><p class="time">'+e[u].opentime+'</p><p class="addr">'+e[u].address+'</p><p class="tel">'+e[u].tel+'</p><p class="free">'+e[u].category+"</p></div>";n.innerHTML=c,$(".list").fadeIn(700),p=t,function(e){for(var t="",a=0;a<e;a++)t+='<button class="btn" data-num="'+(a+1)+'">'+(a+1)+"</button>";l.innerHTML='<button id="prevBtn" data-add="-1">< prev</button>'+t+'<button id="nextBtn" data-add="1">next ></button>'}(i)}}l.addEventListener("click",function(e){if(e.preventDefault(),"button"!==e.target.localName)return;var t,a=parseInt(e.target.dataset.add),n=parseInt(e.target.dataset.num);if(-1==a||1==a){if(-1==a){if(p+a<1)return;t=p-1}else if(1==a){if(p+a>i)return;t=p+1}}else if(p==(t=n))return;$(".list").fadeOut(0),$(".list").fadeIn(700),$("html").animate({scrollTop:0},1e3),y(t)},!1),$(window).scroll(function(){$(document).scrollTop()>=290?$(".topBtn").fadeIn(300):$(".topBtn").fadeOut(300)}),$(".topBtn").click(function(e){e.preventDefault(),$("html,body").animate({scrollTop:0},1e3)})});